<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.includes%2CString.prototype.includes"></script>
    <title>ICJIA IRB | Meetings</title>
    <style>
      a {
        color: black;
        font-weight: bold;
      }
      a:focus {
        border: 2px solid #000;
      }
    </style>
  </head>

  <body>
    <div role="banner" class="site-header">
      <nav class="site-header-quick-menu">
        <a href="#main">Skip to content</a>
      </nav>
    </div>
    <div class="container" id="main" role="main">
      <h1>IRB Meetings</h1>
      <div id="app">LOADING...</div>
    </div>

    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>

    <script>
      var jqxhr = $.getJSON('/irb/api.json', function (data) {
        var arr = []
        $.map(data, function (obj) {
          if (obj.route.includes('meetings')) {
            arr.push(obj)
          }
        })
        var content = '<div>'
        $.each(arr, function (key, value) {
          content =
            content +
            '<div class="meeting" style="padding-bottom: 30px; margin-bottom: 50px; border-bottom: 1px solid #333">'
          content = content + '<h2 id=' + key + '>' + value.title + '</h2>'
          content = content + value.html
          content = content + '</div>'
        })
        content = content + '</div>'

        $('#app').html(content)

        // Fix h2 entities to have unique IDs
        $('h2').each(function () {
          if (this.id) {
            this.id = this.id + Math.floor(Math.random() * 200) + 1
          }
        })

        // Fix links to point to correct destination
        $('a').each(function () {
          var oldHref = $(this).attr('href')
          if (oldHref.includes('pdf')) {
            var newHref = '/' + oldHref
            $(this).attr('href', newHref)
          }
        })
      })
    </script>
  </body>
</html>
